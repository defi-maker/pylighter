# 常见问题 (FAQ)

## 基础问题

### Q: 什么是 Lighter Protocol？
A: Lighter Protocol 是一个去中心化的现货和期货交易协议，支持链上交易和撮合。

### Q: 为什么选择 TON 作为默认币种？
A: 所有币种都有 $10 的最小交易额要求，但 TON 能够以接近这个最小额度进行交易。选择 TON 可以：
- 降低测试成本
- 提高资金利用率
- 减少网格策略的资金需求

### Q: SDK 支持哪些交易类型？
A: 
- ✅ 限价单 (Limit Order)
- ✅ 市价单 (Market Order)  
- ✅ 合约交易 (Long/Short)
- ✅ 杠杆交易 (最低5倍)
- ✅ 订单取消

## 网格策略问题

### Q: 网格策略如何盈利？
A: 网格策略通过在震荡行情中低买高卖获利：
1. 设置价格网格
2. 在网格下边界买入，上边界卖出
3. 价格震荡时重复执行，赚取价差

### Q: 网格策略适合所有行情吗？
A: 不是。网格策略：
- ✅ **震荡行情**: 最适合，能稳定获利
- ❌ **强趋势行情**: 可能产生浮亏
- ⚠️ **横盘整理**: 收益较小但相对安全

### Q: 为什么要使用双向网格？
A: 双向网格的优势：
- 同时做多做空，提高资金利用率
- 部分对冲风险
- 增加获利机会

### Q: 网格间距如何选择？
A: 当前设置为 0.1%，这是基于：
- TON 的历史波动率分析
- 交易成本考虑
- 风险控制需要

可以根据市场情况调整，但建议先在模拟环境测试。

## 技术问题

### Q: 遇到 "21120 无效签名" 错误怎么办？
A: 这通常是认证问题：
1. 检查 `.env` 文件中的 `LIGHTER_KEY` 和 `LIGHTER_SECRET`
2. 确认私钥格式正确（去掉 0x 前缀）
3. 验证 API Key Index 是否正确

### Q: 如何获取 API Key Index？ 
A: 使用 `accountsByL1Address` 接口：
```python
accounts = await lighter.get_accounts_by_l1_address(wallet_address)
# 选择有交易活动的 account index
```

### Q: 为什么交易失败提示 "超过最小交易量"？
A: 需要同时满足两个条件：
- `min_base_amount`: 最小基础货币数量
- `min_quote_amount`: 最小报价金额 ($10)

使用 `max(min_base, min_quote/current_price)` 计算实际最小量。

### Q: 如何处理网络连接问题？
A: 
1. 检查网络连接
2. 确认防火墙设置
3. 尝试重新初始化客户端
4. 查看错误日志确定具体问题

## 风险管理问题

### Q: 网格策略有什么风险？
A: 主要风险包括：
1. **趋势风险**: 单边行情可能导致持续浮亏
2. **保证金风险**: 杠杆交易需要足够保证金
3. **技术风险**: 网络中断或系统故障
4. **流动性风险**: 极端行情下可能无法及时平仓

### Q: 如何控制风险？
A: 
1. **使用最低杠杆**: TON 使用 5倍杠杆
2. **设置持仓限制**: 超过阈值时停止加仓
3. **分散投资**: 不要投入全部资金
4. **实时监控**: 密切关注策略运行状态

### Q: 什么时候应该停止策略？
A: 考虑停止的情况：
- 持续单边行情超过预期
- 浮亏超过承受能力
- 市场流动性极差
- 技术故障无法修复

## 使用问题

### Q: 第一次使用应该怎么开始？
A: 建议步骤：
1. 先运行 `examples/get_info.py` 验证连接
2. 使用 `examples/analyze_minimum_order_amounts.py` 了解市场
3. 运行 `examples/grid_strategy_simulation.py` 模拟测试
4. 小额运行 `examples/ton_contract_trading.py` 真实测试
5. 确认无误后运行网格策略

### Q: 如何监控策略运行状态？
A: 
- 查看终端实时输出
- 检查 `log/grid_ton_lighter.log` 日志文件
- 监控持仓变化
- 关注盈亏状况

### Q: 策略运行多长时间合适？
A: 这取决于：
- 市场行情特点
- 个人风险承受能力
- 策略表现情况
- 可以 24/7 运行，但建议定期检查

### Q: 如何优化策略参数？
A: 
1. **回测分析**: 使用历史数据测试不同参数
2. **小额实盘**: 用少量资金测试参数效果
3. **渐进调整**: 逐步优化，避免大幅改动
4. **记录对比**: 详细记录不同参数的表现

## 开发问题

### Q: 如何添加新的币种支持？
A: 
1. 检查 Lighter Protocol 是否支持该币种
2. 获取币种的精度和最小交易量信息
3. 修改配置文件中的币种参数
4. 测试新币种的交易功能

### Q: 如何自定义交易策略？
A: 
1. 复制 `examples/` 中的相关示例
2. 修改策略逻辑部分
3. 调整参数配置
4. 先进行模拟测试
5. 小额真实测试后正式运行

### Q: 如何扩展 SDK 功能？
A: 
1. 查看 `pylighter/client.py` 了解现有接口
2. 参考 Lighter Protocol 官方 API 文档
3. 添加新的方法到客户端类
4. 编写测试用例验证功能

## 性能问题

### Q: 策略运行速度慢怎么办？
A: 
1. 减少 API 调用频率
2. 优化网络连接
3. 使用批量操作
4. 检查代码逻辑是否高效

### Q: 如何减少交易成本？
A: 
1. 选择低成本币种（如 TON）
2. 优化网格间距设置
3. 减少不必要的交易频率
4. 使用限价单而非市价单

---

如果还有其他问题，请查看：
- [API 参考文档](api-reference.md)
- [网格策略指南](grid-strategy-guide.md)
- [示例代码指南](examples-guide.md)